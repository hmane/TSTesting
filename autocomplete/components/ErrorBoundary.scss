// components/ErrorBoundary.scss
@import '~@fluentui/react/dist/sass/References.scss';

.autocomplete-error-boundary {
  width: 100%;
  margin: 4px 0;

  // MessageBar styling integration with SharePoint theme
  :global(.ms-MessageBar) {
    border-radius: var(--borderRadius, 2px);
    box-shadow: var(--elevation4, 0 1.6px 3.6px 0 rgba(0, 0, 0, 0.132), 0 0.3px 0.9px 0 rgba(0, 0, 0, 0.108));

    // Smooth appearance animation
    animation: slideInFromTop 0.3s cubic-bezier(0.165, 0.84, 0.44, 1);

    // Enhanced spacing for better readability
    :global(.ms-MessageBar-content) {
      padding: 12px 16px;
    }

    // Icon styling
    :global(.ms-MessageBar-icon) {
      margin-right: 8px;

      i {
        color: inherit;
        transition: transform 0.2s ease-in-out;

        &:hover {
          transform: scale(1.1);
        }
      }
    }

    // Dismiss button enhancement
    :global(.ms-MessageBar-dismissal) {
      :global(.ms-Button) {
        transition: all 0.2s ease-in-out;

        &:hover {
          background-color: rgba(255, 255, 255, 0.1);
          border-radius: 50%;
        }
      }
    }
  }

  // Error details expansion
  .autocomplete-error-details {
    margin-top: 8px;
    border: 1px solid var(--palette-neutralLight, #c8c8c8);
    border-radius: var(--borderRadius, 2px);
    background-color: var(--palette-neutralLighter, #f3f2f1);
    transition: all 0.3s ease-in-out;

    summary {
      padding: 8px 12px;
      cursor: pointer;
      font-weight: 600;
      color: var(--palette-neutralPrimary, #323130);
      background-color: var(--palette-neutralLighterAlt, #faf9f8);
      border-radius: var(--borderRadius, 2px);
      transition: background-color 0.2s ease-in-out;
      user-select: none;
      outline: none;

      &:hover {
        background-color: var(--palette-neutralLight, #edebe9);
      }

      &:focus {
        box-shadow: inset 0 0 0 1px var(--palette-themePrimary, #0078d4);
      }

      // Remove default marker
      &::-webkit-details-marker {
        display: none;
      }

      // Custom expand/collapse icon
      &::before {
        content: '\E70D'; // ChevronRight icon
        font-family: 'Fabric MDL2 Icons';
        margin-right: 8px;
        transition: transform 0.2s ease-in-out;
        display: inline-block;
      }
    }

    &[open] {
      summary::before {
        transform: rotate(90deg);
      }
    }

    // Details content styling
    > *:not(summary) {
      padding: 12px;
      border-top: 1px solid var(--palette-neutralLight, #c8c8c8);
      animation: expandContent 0.3s ease-out;
    }

    .autocomplete-error-stack {
      background-color: var(--palette-black, #000000);
      color: var(--palette-white, #ffffff);
      padding: 12px;
      border-radius: var(--borderRadius, 2px);
      font-family: 'Cascadia Code', 'Consolas', 'Monaco', monospace;
      font-size: 11px;
      line-height: 1.4;
      overflow-x: auto;
      white-space: pre-wrap;
      word-break: break-all;
      margin: 8px 0 0 0;
      border: 1px solid var(--palette-neutralTertiary, #a19f9d);

      // Scrollbar styling for better UX
      &::-webkit-scrollbar {
        height: 6px;
      }

      &::-webkit-scrollbar-track {
        background-color: rgba(255, 255, 255, 0.1);
        border-radius: 3px;
      }

      &::-webkit-scrollbar-thumb {
        background-color: var(--palette-neutralSecondary, #605e5c);
        border-radius: 3px;

        &:hover {
          background-color: var(--palette-neutralPrimary, #323130);
        }
      }
    }
  }

  // Retry button enhancement
  :global(.ms-Button--default) {
    transition: all 0.2s ease-in-out;

    &:hover {
      transform: translateY(-1px);
      box-shadow: var(--elevation8, 0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132), 0 0.6px 1.8px 0 rgba(0, 0, 0, 0.108));
    }

    &:active {
      transform: translateY(0);
    }

    // Loading state for retry button
    &.is-loading {
      pointer-events: none;
      opacity: 0.7;

      :global(.ms-Button-icon) {
        animation: spin 1s linear infinite;
      }
    }
  }

  // Responsive design
  @media screen and (max-width: 640px) {
    .autocomplete-error-details {
      .autocomplete-error-stack {
        font-size: 10px;
        padding: 8px;
      }
    }
  }

  // High contrast mode support
  @media screen and (-ms-high-contrast: active) {
    :global(.ms-MessageBar) {
      border: 2px solid WindowText;
    }

    .autocomplete-error-details {
      border: 1px solid WindowText;

      summary {
        border-bottom: 1px solid WindowText;
      }
    }
  }

  // Reduced motion support
  @media (prefers-reduced-motion: reduce) {
    :global(.ms-MessageBar),
    .autocomplete-error-details,
    summary,
    :global(.ms-Button--default) {
      animation: none;
      transition: none;
    }

    summary::before {
      transition: none;
    }
  }
}

// Animations
@keyframes slideInFromTop {
  from {
    opacity: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes expandContent {
  from {
    opacity: 0;
    max-height: 0;
  }
  to {
    opacity: 1;
    max-height: 200px;
  }
}

@keyframes spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}
